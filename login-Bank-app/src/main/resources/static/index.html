<script>
    const BASE_URL = "https://spring-boot-app-xxxx.onrender.com/Bank";
    let token = localStorage.getItem("jwtToken");

    function showMessage(msg) {
      document.getElementById("message").innerText = msg;
    }

    async function signup() {
      const name = document.getElementById("signupName").value;
      const mobile = document.getElementById("signupMobile").value;
      const password = document.getElementById("signupPassword").value;

      const res = await fetch(`${BASE_URL}/signup`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ name, mobile, password })
      });

      showMessage(await res.text());
    }

    async function login() {
      const mobile = document.getElementById("loginMobile").value;
      const password = document.getElementById("loginPassword").value;

      const res = await fetch(`${BASE_URL}/login`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ mobile, password })
      });

      const data = await res.text();
      showMessage(data);

      if (data.includes("TOKEN:")) {
        token = data.split("TOKEN:")[1].trim();
        localStorage.setItem("jwtToken", token);
        document.getElementById("authPage").style.display = "none";
        document.getElementById("dashboard").style.display = "block";
      }
    }

    async function balance() {
      const res = await fetch(`${BASE_URL}/balance`, {
        headers: { Authorization: "Bearer " + token }
      });
      showMessage(await res.text());
    }

    async function deposit() {
      const res = await fetch(`${BASE_URL}/deposit/100`, {
        method: "PUT",
        headers: { Authorization: "Bearer " + token }
      });
      showMessage(await res.text());
    }

    async function withdraw() {
      const res = await fetch(`${BASE_URL}/withdraw/50`, {
        method: "PUT",
        headers: { Authorization: "Bearer " + token }
      });
      showMessage(await res.text());
    }

    async function deleteAccount() {
      const res = await fetch(`${BASE_URL}/delete`, {
        method: "DELETE",
        headers: { Authorization: "Bearer " + token }
      });
      showMessage(await res.text());
      localStorage.removeItem("jwtToken");
      token = null;
    }

    function logout() {
      localStorage.removeItem("jwtToken");
      token = null;
      document.getElementById("authPage").style.display = "block";
      document.getElementById("dashboard").style.display = "none";
    }
</script>
