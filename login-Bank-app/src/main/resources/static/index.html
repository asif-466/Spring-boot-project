<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Banking App</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
          font-family: "Roboto", sans-serif;
          background: #fafafa;
          display: flex;
          justify-content: center;
          align-items: center;
          height: 100vh;
        }
        .app {
          width: 100%;
          max-width: 400px;
          background: #fff;
          border-radius: 15px;
          box-shadow: 0 8px 20px rgba(0,0,0,0.15);
          padding: 20px;
        }
        h2 {
          text-align: center;
          margin-bottom: 20px;
          color: #333;
        }
        label {
          font-size: 14px;
          margin: 8px 0 4px;
          color: #555;
          display: block;
        }
        input {
          width: 100%;
          padding: 12px;
          border: 1px solid #ccc;
          border-radius: 10px;
          margin-bottom: 10px;
          font-size: 14px;
        }
        button {
          width: 100%;
          padding: 12px;
          margin-top: 10px;
          border: none;
          border-radius: 10px;
          background: #0095f6;
          color: #fff;
          font-weight: bold;
          cursor: pointer;
        }
        button:hover { background: #007acc; }
        .switch {
          text-align: center;
          margin-top: 15px;
          font-size: 14px;
          color: #555;
          cursor: pointer;
        }
        .switch span { color: #0095f6; font-weight: 600; }
        #dashboard { display: none; margin-top: 20px; }
        #dashboard button { margin-top: 8px; }
    </style>
</head>
<body>
<div class="app">
    <!-- AUTH SCREENS -->
    <div id="authPage">
        <!-- Login -->
        <div id="loginCard">
            <h2>Login</h2>
            <label>Mobile</label>
            <input type="text" id="loginMobile">
            <label>Password</label>
            <input type="password" id="loginPassword">
            <button onclick="login()">Login</button>
            <div class="switch">Don’t have an account? <span onclick="showSignup()">Signup</span></div>
        </div>

        <!-- Signup -->
        <div id="signupCard" style="display:none;">
            <h2>Signup</h2>
            <label>Name</label>
            <input type="text" id="signupName">
            <label>Mobile</label>
            <input type="text" id="signupMobile">
            <label>Password</label>
            <input type="password" id="signupPassword">
            <button onclick="signup()">Signup</button>
            <div class="switch">Already have an account? <span onclick="showLogin()">Login</span></div>
        </div>
    </div>

    <!-- DASHBOARD -->
    <div id="dashboard">
        <h2>Dashboard</h2>
        <button onclick="balance()">Check Balance</button>
        <button onclick="deposit()">Deposit 100</button>
        <button onclick="withdraw()">Withdraw 50</button>
        <button onclick="deleteAccount()">Delete Account</button>
        <button onclick="logout()">Logout</button>
    </div>
</div>

<script>
    const BASE_URL = "https://spring-boot-app-fl4i.onrender.com/Bank";
    let token = localStorage.getItem("jwtToken");

    function toggleAuth(isLoggedIn) {
      document.getElementById("authPage").style.display = isLoggedIn ? "none" : "block";
      document.getElementById("dashboard").style.display = isLoggedIn ? "block" : "none";
    }

    function showSignup() {
      document.getElementById("loginCard").style.display = "none";
      document.getElementById("signupCard").style.display = "block";
    }

    function showLogin() {
      document.getElementById("signupCard").style.display = "none";
      document.getElementById("loginCard").style.display = "block";
    }

    async function signup() {
      const name = document.getElementById("signupName").value;
      const mobile = document.getElementById("signupMobile").value;
      const password = document.getElementById("signupPassword").value;
      const res = await fetch(`${BASE_URL}/signup`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ name, mobile, password })
      });
      alert(await res.text());
    }

    async function login() {
      const mobile = document.getElementById("loginMobile").value;
      const password = document.getElementById("loginPassword").value;
      const res = await fetch(`${BASE_URL}/login`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ mobile, password })
      });
      const data = await res.text();
      if (data.includes("TOKEN:")) {
        token = data.split("TOKEN:")[1].trim();
        localStorage.setItem("jwtToken", token);
        alert("Login success ✅");
        toggleAuth(true);
      } else {
        alert("Login failed ❌");
      }
    }

    async function balance() {
      const res = await fetch(`${BASE_URL}/balance`, {
        headers: { Authorization: "Bearer " + token }
      });
      alert(await res.text());
    }

    async function deposit() {
      const res = await fetch(`${BASE_URL}/deposit/100`, {
        method: "PUT",
        headers: { Authorization: "Bearer " + token }
      });
      alert(await res.text());
    }

    async function withdraw() {
      const res = await fetch(`${BASE_URL}/withdraw/50`, {
        method: "PUT",
        headers: { Authorization: "Bearer " + token }
      });
      alert(await res.text());
    }

    async function deleteAccount() {
      const res = await fetch(`${BASE_URL}/delete`, {
        method: "DELETE",
        headers: { Authorization: "Bearer " + token }
      });
      alert(await res.text());
      localStorage.removeItem("jwtToken");
      token = null;
      toggleAuth(false);
    }

    function logout() {
      localStorage.removeItem("jwtToken");
      token = null;
      toggleAuth(false);
      alert("Logged out");
    }

    // init
    toggleAuth(!!token);
</script>
</body>
</html>
