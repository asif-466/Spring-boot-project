<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Bank App</title>
    <style>
        body {
          font-family: Arial, sans-serif;
          background: linear-gradient(to right, #6a11cb, #2575fc);
          color: white;
          text-align: center;
          padding: 20px;
        }
        .container {
          max-width: 400px;
          margin: auto;
          background: rgba(0,0,0,0.6);
          padding: 20px;
          border-radius: 15px;
          box-shadow: 0px 4px 10px rgba(0,0,0,0.3);
        }
        input, button {
          width: 90%;
          padding: 10px;
          margin: 8px 0;
          border: none;
          border-radius: 8px;
        }
        input {
          background: #f1f1f1;
          color: black;
        }
        button {
          background: #ff9800;
          color: white;
          font-weight: bold;
          cursor: pointer;
          transition: 0.3s;
        }
        button:hover {
          background: #e68900;
        }
        h2 {
          margin-top: 20px;
        }
        #actions { display: none; }
    </style>
</head>
<body>
<div class="container">
    <h1>Bank App</h1>

    <!-- Signup -->
    <h2>Signup</h2>
    <input type="text" id="signupName" placeholder="Enter Name"><br>
    <input type="text" id="signupMobile" placeholder="Enter Mobile"><br>
    <input type="number" id="signupBalance" placeholder="Enter Initial Balance"><br>
    <button onclick="signup()">Signup</button>
    <p id="signupResult"></p>

    <!-- Login -->
    <h2>Login</h2>
    <input type="text" id="loginMobile" placeholder="Enter Mobile"><br>
    <input type="password" id="loginPassword" placeholder="Enter Password"><br>
    <button onclick="login()">Login</button>
    <p id="loginResult"></p>

    <!-- After Login -->
    <div id="actions">
        <h2>Account Actions</h2>
        <button onclick="balance()">Check Balance</button>
        <button onclick="deposit()">Deposit</button>
        <button onclick="withdraw()">Withdraw</button>
        <button onclick="sendMoney()">Send Money</button>
        <button onclick="deleteAccount()">Delete Account</button>
        <button onclick="logout()">Logout</button>
        <p id="actionResult"></p>
    </div>
</div>

<script>
    let token = "";

    function signup() {
      const name = document.getElementById("signupName").value;
      const mobile = document.getElementById("signupMobile").value;
      const balance = parseFloat(document.getElementById("signupBalance").value);

      fetch("https://spring-boot-app-fl4i.onrender.com/Bank/signup", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ name, mobile, balance })
      })
      .then(res => res.json())
      .then(data => {
        document.getElementById("signupResult").innerText = "Signup Successful!";
      })
      .catch(err => {
        document.getElementById("signupResult").innerText = "Signup Failed!";
      });
    }

    function login() {
      const mobile = document.getElementById("loginMobile").value;
      const password = document.getElementById("loginPassword").value;

      fetch("https://spring-boot-app-fl4i.onrender.com/Bank/login", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ mobile, password })
      })
      .then(res => res.text())
      .then(data => {
        if (data.startsWith("ey")) { // token usually starts with "ey..."
          token = data;
          document.getElementById("loginResult").innerText = "Login Successful!";
          document.getElementById("actions").style.display = "block";
        } else {
          document.getElementById("loginResult").innerText = "Login Failed!";
        }
      })
      .catch(err => {
        document.getElementById("loginResult").innerText = "Login Failed!";
      });
    }

    function balance() {
      fetch("https://spring-boot-app-fl4i.onrender.com/Bank/balance", {
        method: "GET",
        headers: { "Authorization": "Bearer " + token }
      })
      .then(res => res.text())
      .then(data => {
        document.getElementById("actionResult").innerText = "Balance: " + data;
      });
    }

    function deposit() {
      const amount = prompt("Enter deposit amount:");
      fetch(`https://spring-boot-app-fl4i.onrender.com/Bank/deposit/${amount}`, {
        method: "PUT",
        headers: { "Authorization": "Bearer " + token }
      })
      .then(res => res.text())
      .then(data => {
        document.getElementById("actionResult").innerText = data;
      });
    }

    function withdraw() {
      const amount = prompt("Enter withdraw amount:");
      fetch(`https://spring-boot-app-fl4i.onrender.com/Bank/withdraw/${amount}`, {
        method: "PUT",
        headers: { "Authorization": "Bearer " + token }
      })
      .then(res => res.text())
      .then(data => {
        document.getElementById("actionResult").innerText = data;
      });
    }

    function sendMoney() {
      const receiver = prompt("Enter receiver mobile:");
      const amount = prompt("Enter amount to send:");
      fetch(`https://spring-boot-app-fl4i.onrender.com/Bank/send/${receiver}/${amount}`, {
        method: "PUT",
        headers: { "Authorization": "Bearer " + token }
      })
      .then(res => res.text())
      .then(data => {
        document.getElementById("actionResult").innerText = data;
      });
    }

    function deleteAccount() {
      fetch("https://spring-boot-app-fl4i.onrender.com/Bank/delete", {
        method: "DELETE",
        headers: { "Authorization": "Bearer " + token }
      })
      .then(res => res.text())
      .then(data => {
        document.getElementById("actionResult").innerText = data;
        logout();
      });
    }

    function logout() {
      token = "";
      document.getElementById("actions").style.display = "none";
      document.getElementById("loginResult").innerText = "Logged out!";
    }
</script>
</body>
</html>
