<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Bank App</title>
    <style>
        body {
          font-family: Arial, sans-serif;
          background: linear-gradient(to right, #f9a8d4, #a78bfa);
          display: flex;
          justify-content: center;
          align-items: center;
          height: 100vh;
          margin: 0;
        }
        .container {
          background: #fff;
          padding: 30px;
          border-radius: 15px;
          width: 350px;
          box-shadow: 0px 4px 20px rgba(0,0,0,0.2);
          text-align: center;
        }
        h2 {
          color: #4c1d95;
          margin-bottom: 20px;
        }
        input {
          width: 90%;
          padding: 10px;
          margin: 8px 0;
          border: 1px solid #ddd;
          border-radius: 8px;
        }
        button {
          background: #9333ea;
          color: white;
          border: none;
          padding: 10px 15px;
          border-radius: 8px;
          cursor: pointer;
          margin-top: 10px;
          width: 95%;
        }
        button:hover {
          background: #7e22ce;
        }
        .switch {
          margin-top: 15px;
          color: #2563eb;
          cursor: pointer;
        }
        #response {
          margin-top: 15px;
          font-weight: bold;
        }
        #dashboard button {
          margin-top: 12px;
        }
    </style>
</head>
<body>
<!-- Signup Box -->
<div class="container" id="signupBox">
    <h2>Signup</h2>
    <input type="text" id="signupName" placeholder="Name">
    <input type="text" id="signupMobile" placeholder="Mobile">
    <input type="password" id="signupPassword" placeholder="Password">
    <button onclick="signup()">Signup</button>
    <div class="switch" onclick="showLogin()">Already have an account? Login</div>
    <div id="signupResponse"></div>
</div>

<!-- Login Box -->
<div class="container" id="loginBox" style="display:none;">
    <h2>Login</h2>
    <input type="text" id="loginMobile" placeholder="Mobile">
    <input type="password" id="loginPassword" placeholder="Password">
    <button onclick="login()">Login</button>
    <div class="switch" onclick="showSignup()">Don't have an account? Signup</div>
    <div id="loginResponse"></div>
</div>

<!-- Dashboard -->
<div class="container" id="dashboard" style="display:none;">
    <h2>Welcome!</h2>
    <button onclick="checkBalance()">Check Balance</button>
    <button onclick="deposit()">Deposit Money</button>
    <button onclick="withdraw()">Withdraw Money</button>
    <button onclick="sendMoney()">Send Money</button>
    <button onclick="logout()">Logout</button>
    <div id="dashboardResponse"></div>
</div>

<script>
    const BASE_URL = "https://spring-boot-app-fl4i.onrender.com/Bank";
    let token = "";

    function showLogin() {
      document.getElementById("signupBox").style.display = "none";
      document.getElementById("loginBox").style.display = "block";
      document.getElementById("dashboard").style.display = "none";
    }
    function showSignup() {
      document.getElementById("loginBox").style.display = "none";
      document.getElementById("signupBox").style.display = "block";
      document.getElementById("dashboard").style.display = "none";
    }
    function showDashboard() {
      document.getElementById("loginBox").style.display = "none";
      document.getElementById("signupBox").style.display = "none";
      document.getElementById("dashboard").style.display = "block";
    }

    async function signup() {
      const name = document.getElementById("signupName").value;
      const mobile = document.getElementById("signupMobile").value;
      const password = document.getElementById("signupPassword").value;

      try {
        const res = await fetch(`${BASE_URL}/signup`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ name, mobile, password })
        });

        if (res.ok) {
          document.getElementById("signupResponse").innerText = "Signup Successful!";
        } else {
          document.getElementById("signupResponse").innerText = "Signup Failed!";
        }
      } catch (e) {
        document.getElementById("signupResponse").innerText = "Error!";
      }
    }

    async function login() {
      const mobile = document.getElementById("loginMobile").value;
      const password = document.getElementById("loginPassword").value;

      try {
        const res = await fetch(`${BASE_URL}/login`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ mobile, password })
        });

        const data = await res.text();
        if (res.ok) {
          token = data;
          showDashboard();
        } else {
          document.getElementById("loginResponse").innerText = "Login Failed!";
        }
      } catch (e) {
        document.getElementById("loginResponse").innerText = "Error!";
      }
    }

    async function checkBalance() {
      try {
        const res = await fetch(`${BASE_URL}/balance`, {
          headers: { "Authorization": "Bearer " + token }
        });
        document.getElementById("dashboardResponse").innerText = await res.text();
      } catch {
        document.getElementById("dashboardResponse").innerText = "Error!";
      }
    }

    async function deposit() {
      const amount = prompt("Enter deposit amount:");
      try {
        const res = await fetch(`${BASE_URL}/deposit/${amount}`, {
          method: "PUT",
          headers: { "Authorization": "Bearer " + token }
        });
        document.getElementById("dashboardResponse").innerText = await res.text();
      } catch {
        document.getElementById("dashboardResponse").innerText = "Error!";
      }
    }

    async function withdraw() {
      const amount = prompt("Enter withdraw amount:");
      try {
        const res = await fetch(`${BASE_URL}/withdraw/${amount}`, {
          method: "PUT",
          headers: { "Authorization": "Bearer " + token }
        });
        document.getElementById("dashboardResponse").innerText = await res.text();
      } catch {
        document.getElementById("dashboardResponse").innerText = "Error!";
      }
    }

    async function sendMoney() {
      const receiver = prompt("Enter receiver mobile:");
      const amount = prompt("Enter amount:");
      try {
        const res = await fetch(`${BASE_URL}/send/${receiver}/${amount}`, {
          method: "PUT",
          headers: { "Authorization": "Bearer " + token }
        });
        document.getElementById("dashboardResponse").innerText = await res.text();
      } catch {
        document.getElementById("dashboardResponse").innerText = "Error!";
      }
    }

    function logout() {
      token = "";
      showLogin();
    }
</script>
</body>
</html>
